import { Head, Appear, Image, withDeck } from 'mdx-deck'  // https://github.com/jxnblk/mdx-deck
import { CodeSurfer } from "mdx-deck-code-surfer"
import { FullScreenCode } from "mdx-deck/layouts";
import nightOwl from "prism-react-renderer/themes/nightOwl"
import ReplIt from "../../components/replit";

## Promise Chaining

- A `Promise` returns a `Promise`
- Once inside of a `.then` - the return value is turned into a promise, if it isn't already
- You can chain as many `.then` as you need 

---
<CodeSurfer
  code={require("!raw-loader!./snippets/promise-chain.snippet")}
  theme={nightOwl}
  lang="javascript"
  title="Promise Chains"
  showNumbers
  steps={[
    {}, // First step should be an overview of the snippet
    {lines: [2], notes: "This returns a promise"},
    {range: [6,8], notes: "Once inside a then - it wraps the result in a promise"},
    {range: [9,11], notes: "Allowing us to chain operations together"},
    {range: [13,21], notes: "Similar to the managers"},
    {range: [17,18], notes: "But easy to add new features / requirements"},
    {}
  ]}
/>
---

### Keeping These Functions Simple Can Help Identify Reusable Patterns

<ul style={{listStyle: 'none'}}>
<Appear>
    <li>Filtering by a User Type</li>
    <li>Calculating the Total of a Value</li>
</Appear>
</ul>

---
<CodeSurfer
  code={require("!raw-loader!./snippets/promise-chain-2.snippet")}
  theme={nightOwl}
  lang="javascript"
  title="Extracting Reusability"
  showNumbers
  steps={[
    {range: [5,8], notes: 'Extract Reusable Logic'}, 
    {range: [11,12], notes: 'Use in Promise Chain'}, 
    {range: [15,17], notes: 'Reuse Same Functions in New Context'}, 
    {}
  ]}
/>

---
## Those Functions Can Live in Another File

- Easier to Reuse 
- Easier to Test 
- Can Test Synchronously

---
<CodeSurfer
  code={require("!raw-loader!./snippets/promise-chain-4.snippet")}
  theme={nightOwl}
  lang="javascript"
  title="Can Live in a Shared Location"
  showNumbers
  steps={[
    {range: [1,4], notes: 'Pure, Simple, Synchronous'}, 
    {lines: [6], notes: 'Export for Reuse'}, 
    {}
  ]}
/>
---
<CodeSurfer
  code={require("!raw-loader!./snippets/promise-chain-3.snippet")}
  theme={nightOwl}
  lang="javascript"
  title="Improved Reuse"
  showNumbers
  steps={[
    {},
    {lines: [1], notes: "Import where you need"},
    {range: [8,10], notes: "Cleans up your code"}, 
    {}
  ]}
/>
